!function(){function e(e,r){var i=[];if(!r)return e;for(var o in r)i.push(o+"="+encodeURIComponent(r[o]));return e+(-1!=e.indexOf("?")?"&":"?")+i.join("&")}function r(e){e+="";var r=e.charAt(0).toUpperCase();return r+e.substr(1)}function i(){var i=this.getDialog(),o=i.getParentEditor();o._.filebrowserSe=this;var t=o.config["filebrowser"+r(i.getName())+"WindowWidth"]||o.config.filebrowserWindowWidth||"80%",n=o.config["filebrowser"+r(i.getName())+"WindowHeight"]||o.config.filebrowserWindowHeight||"70%",l=this.filebrowser.params||{};l.CKEditor=o.name,l.CKEditorFuncNum=o._.filebrowserFn,l.langCode||(l.langCode=o.langCode);var f=e(this.filebrowser.url,l);o.popup(f,t,n,o.config.filebrowserWindowFeatures||o.config.fileBrowserWindowFeatures)}function o(){var e=this.getDialog(),r=e.getParentEditor();return r._.filebrowserSe=this,e.getContentElement(this["for"][0],this["for"][1]).getInputElement().$.value?e.getContentElement(this["for"][0],this["for"][1]).getAction()?!0:!1:!1}function t(r,i,o){var t=o.params||{};t.CKEditor=r.name,t.CKEditorFuncNum=r._.filebrowserFn,t.langCode||(t.langCode=r.langCode),i.action=e(o.url,t),i.filebrowser=o}function n(e,l,f,s){if(s&&s.length)for(var a,d=s.length;d--;)if(a=s[d],("hbox"==a.type||"vbox"==a.type||"fieldset"==a.type)&&n(e,l,f,a.children),a.filebrowser){if("string"==typeof a.filebrowser){var w={action:"fileButton"==a.type?"QuickUpload":"Browse",target:a.filebrowser};a.filebrowser=w}if("Browse"==a.filebrowser.action){var g=a.filebrowser.url;void 0===g&&(g=e.config["filebrowser"+r(l)+"BrowseUrl"],void 0===g&&(g=e.config.filebrowserBrowseUrl)),g&&(a.onClick=i,a.filebrowser.url=g,a.hidden=!1)}else if("QuickUpload"==a.filebrowser.action&&a["for"]&&(g=a.filebrowser.url,void 0===g&&(g=e.config["filebrowser"+r(l)+"UploadUrl"],void 0===g&&(g=e.config.filebrowserUploadUrl)),g)){var u=a.onClick;a.onClick=function(e){var r=e.sender;return u&&u.call(r,e)===!1?!1:o.call(r,e)},a.filebrowser.url=g,a.hidden=!1,t(e,f.getContents(a["for"][0]).get(a["for"][1]),a.filebrowser)}}}function l(e,r){var i=r.getDialog(),o=r.filebrowser.target||null;if(o){var t=o.split(":"),n=i.getContentElement(t[0],t[1]);n&&(n.setValue(e),i.selectPage(t[0]))}}function f(e,r,i){if(-1!==i.indexOf(";")){for(var o=i.split(";"),t=0;t<o.length;t++)if(f(e,r,o[t]))return!0;return!1}var n=e.getContents(r).get(i).filebrowser;return n&&n.url}function s(e,r){var i=this._.filebrowserSe.getDialog(),o=this._.filebrowserSe["for"],t=this._.filebrowserSe.filebrowser.onSelect;o&&i.getContentElement(o[0],o[1]).reset(),("function"!=typeof r||r.call(this._.filebrowserSe)!==!1)&&(t&&t.call(this._.filebrowserSe,e,r)===!1||("string"==typeof r&&r&&alert(r),e&&l(e,this._.filebrowserSe)))}CKEDITOR.plugins.add("filebrowser",{requires:"popup",init:function(e){e._.filebrowserFn=CKEDITOR.tools.addFunction(s,e),e.on("destroy",function(){CKEDITOR.tools.removeFunction(this._.filebrowserFn)})}}),CKEDITOR.on("dialogDefinition",function(e){if(e.editor.plugins.filebrowser)for(var r,i=e.data.definition,o=0;o<i.contents.length;++o)(r=i.contents[o])&&(n(e.editor,e.data.name,i,r.elements),r.hidden&&r.filebrowser&&(r.hidden=!f(i,r.id,r.filebrowser)))})}();